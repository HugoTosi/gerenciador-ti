<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Colaboradores - Insumos de TI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        body {
            background-color: #f8f9fa;
        }

        .action-btn {
            padding: 0.25rem 0.6rem;
        }

        .hover-row:hover {
            background-color: #f1f1f1;
            transition: 0.2s;
        }
    </style>
</head>
<body>

<!--TEMPLATES-->
<template id="templateColaborador">
    <tr class="hover-row">
        <td class="col-id"></td>
        <td class="col-nome"></td>
        <td class="col-cargo"></td>
        <td class="col-setor"></td>
        <td class="col-email"></td>
        <td class="text-center">
            <button class="btn btn-sm btn-primary action-btn me-1 btn-editar">
                <i class="bi bi-pencil-square"></i> Editar
            </button>
            <button class="btn btn-sm btn-danger action-btn btn-inativar">
                <i class="bi bi-x-circle"></i> Inativar
            </button>
        </td>
    </tr>
</template>


<!-- CONTEÚDO PRINCIPAL -->
<div id="navbar"></div>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h3>Colaboradores Ativos</h3>
        <div>
            <button class="btn btn-success me-2" id="btnNovo">
                <i class="bi bi-person-plus"></i> Novo Colaborador
            </button>
            <button class="btn btn-secondary" id="btnInativos">
                <i class="bi bi-people"></i> Ver Inativados
            </button>
        </div>
    </div>

    <!-- TABELA -->
    <div class="card shadow-sm">
        <div class="card-body">
            <table class="table table-hover align-middle">
                <thead class="table-dark">
                <tr>
                    <th>#</th>
                    <th>Nome</th>
                    <th>Cargo</th>
                    <th>Setor</th>
                    <th>Email</th>
                    <th class="text-center">Ações</th>
                </tr>
                </thead>
                <tbody id="tabelaColaboradores"></tbody>
            </table>
        </div>
    </div>
</div>

<!-- IMPORTAÇÕES JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<script>
    $(function(){
        $("#navbar").load("/navbar.html");
    });

    // Comportamentos de botão
    $(document).ready(function(){
        $.get("/api/getColaboradores", function(data){
            console.log("data", data);
            const tabela = document.getElementById("tabelaColaboradores");
            const template = document.getElementById("templateColaborador");
            data.forEach(colaborador => {
                const clone = template.content.cloneNode(true);
                clone.querySelector(".col-id").textContent = colaborador.id;
                clone.querySelector(".col-nome").textContent = colaborador.nome;
                clone.querySelector(".col-cargo").textContent = colaborador.cargo;
                clone.querySelector(".col-setor").textContent = colaborador.setor;
                clone.querySelector(".col-email").textContent = colaborador.email;
                clone.querySelector(".btn-inativar").addEventListener("click", function(){
                    inativarColaborador(colaborador.id);
                });

                tabela.appendChild(clone);
            })
        })

        $("#btnNovo").click(function(){
            window.location.href = "/colaboradores/novo";
        });

        $("#btnInativos").click(function(){
            window.location.href = "/colaboradores/inativos";
        });
    });

    function inativarColaborador(id) {
        $.ajax({
            url: "/api/inativarColaborador/" + id,
            method: "PATCH",
            contentType: "application/json",

            success:  function (data) {
                alert(data)
                window.location.reload()
            },

            error: function (data) {
                alert(data)
            }
        })
    }
</script>

</body>
</html>
